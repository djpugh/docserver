name: Test Build

on: pull_request

jobs:
    build:
      runs-on: ubuntu-latest
      strategy:
        max-parallel: 4
        matrix:
          python-version: [3.7]
      if: github.event_name == 'pull_request' && github.event.target_ref == 'master'
      steps:
        - uses: actions/checkout@v1
        - name: Set up Python ${{ matrix.python-version }}
          uses: actions/setup-python@v1
          with:
            python-version: ${{ matrix.python-version }}
        - name: Install dependencies
          run: |
            python -m pip install --upgrade pip
            pip install tox
        - name: Build Package
          run: tox -e build-package
        - name: Build Container
          run: tox -e build-docker
